webpackJsonp([11,9],{0:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var o=n(236),u=(r(o),n(12)),a=r(u),i=n(123),d=(r(i),n(124)),s=(r(d),n(178)),l=r(s),c=n(144),f=r(c),_=n(244),h=r(_);a["default"].config.debug=!0;var p=a["default"].extend({store:f["default"]});h["default"].start(p,"#app"),l["default"].attach(document.body)},10:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SET_GOODS_CATEGORY_TREE="SET_GOODS_CATEGORY_TREE",t.SET_GOODS_CATEGORY_CURRENT_PID="SET_GOODS_CATEGORY_CURRENT_PID",t.SET_GOODS_LIST="SET_GOODS_LIST",t.SET_GOODS_LIST_LOADED="SET_GOODS_LIST_LOADED",t.SET_GOODS_LIST_LOADED_SUCCESS="SET_GOODS_LIST_LOADED_SUCCESS",t.SET_GOODS_DETAIL_ITEM="SET_GOODS_DETAIL_ITEM",t.SET_AUTH="SET_AUTH",t.CANCEL_AUTH="CANCEL_AUTH",t.ADD_TO_CART="ADD_TO_CART",t.UPDATE_CART_MIRROR="UPDATE_CART_MIRROR",t.CHECKOUT_REQUEST="CHECKOUT_REQUEST",t.CHECKOUT_SUCCESS="CHECKOUT_SUCCESS",t.CHECKOUT_FAILURE="CHECKOUT_FAILURE"},23:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(142),u=r(o),a=n(104),i=r(a),d=n(105),s=r(d),l=n(106),c=r(l),f=n(22),_=r(f),h=n(237),p=r(h),T=n(12),E=r(T),m=n(64),g=r(m),O=n(65),v=r(O),S=n(48),y=n(124),D=r(y);E["default"].use(v["default"]),E["default"].use(D["default"]);var C=new p["default"];E["default"].http.interceptors.push(function(e,t){t(function(e){"Authorization"in e.headers&&(g["default"].set(S.TOKEN_KEY,e.headers.Authorization,{exp:604800}),v["default"].set(S.TOKEN_KEY,e.headers.Authorization,7)),"Content-Type"in e.headers&&"application/json"==e.headers["Content-Type"]&&"object"!=(0,_["default"])(e.data)&&(e.data=JSON.parse(e.data)),"content-type"in e.headers&&"application/json"==e.headers["content-type"]&&"object"!=(0,_["default"])(e.data)&&(e.data=JSON.parse(e.data))})});var A=function(){function e(t){(0,s["default"])(this,e),this.memory=t}return(0,c["default"])(e,[{key:"request",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=arguments[1],n=arguments[2],r=e.params===Object(e.params)?e.params:{},o=g["default"].get(S.TOKEN_KEY)?g["default"].get(S.TOKEN_KEY):v["default"].get(S.TOKEN_KEY);o&&(0,i["default"])(r,{token:o}),E["default"].http({root:S.API_ROOT,url:e.url||"",method:e.method||"GET",params:r,timeout:5e3}).then(function(e){t(e)},function(e){n(e),e.status>=500&&console.log("==> 服务器错误! status: "+e.status+"  message: "+e.statusText)})}},{key:"tokenLogin",value:function(e,t){var n=g["default"].get(S.TOKEN_KEY)?g["default"].get(S.TOKEN_KEY):v["default"].get(S.TOKEN_KEY);n?this.request({url:"member/login/token",method:"GET"},function(t){e(t)},function(e){g["default"]["delete"](S.TOKEN_KEY),v["default"]["delete"](S.TOKEN_KEY),t(e)}):t()}},{key:"search",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this,n=arguments[1],r=arguments[2],o={url:"goods/search",method:"GET",params:e},a=(0,u["default"])(o);this.memory.has(a)?setTimeout(function(){return n(t.memory.get(a))},0):this.request(o,function(e){setTimeout(function(){return n(e.data)},0),t.memory.set(a,e.data),console.log("===> 搜索商品")},function(e){setTimeout(function(){return r(e)},0),console.log("===> 搜索商品失败!",e)})}},{key:"getGoodsCategoryTree",value:function(e,t){var n={url:"goods/category/tree",method:"GET",params:{}},r="goods_category_tree",o=g["default"].get(r);null!==o?setTimeout(function(){return e(o)},0):this.request(n,function(t){setTimeout(function(){return e(t.data)},0),setTimeout(function(){return g["default"].set(r,t.data,{exp:86400})},0),console.log("===> 获取类目树")},function(e){setTimeout(function(){return t(e)},0),console.log("===> 获取类目树失败!",e)})}}]),e}();t["default"]=new A(C)},48:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.API_ROOT="http://192.168.0.108",t.IMG_ROOT="http://192.168.0.108/shop-wap/",t.SEC_IMG_ROOT="http://shop.app",t.TOKEN_KEY="api_token"},64:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(243),u=r(o),a=new u["default"];a.deleteAllExpires(),t["default"]=a},65:function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}var o,u,a=n(22),i=r(a);!function(){var n={install:function(e){e.prototype.$cookie=this},set:function(e,t,n){var r=new Date;r.setTime(r.getTime()+864e5*n),window.document.cookie=e+"="+t+";path=/;expires="+r.toGMTString()},get:function(e){var t=window.document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return t?t[2]:null},"delete":function(e){this.set(e,"",-1)}};"object"==(0,i["default"])(t)?e.exports=n:(o=[],u=function(){return n}.apply(t,o),!(void 0!==u&&(e.exports=u)))}()},144:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),u=r(o),a=n(163),i=r(a),d=n(247),s=r(d),l=n(249),c=r(l),f=n(248),_=r(f),h=n(250),p=r(h);u["default"].use(i["default"]),t["default"]=new i["default"].Store({strict:!0,modules:{cart:s["default"],goodsList:c["default"],goodsCategory:_["default"],member:p["default"]}})},243:function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}var o,u,a=n(142),i=r(a),d=n(22),s=r(d);!function(r,a){o=a,u="function"==typeof o?o.call(t,n,t,e):o,!(void 0!==u&&(e.exports=u))}(void 0,function(){"use strict";function e(e,t){for(var n in t)e[n]=t[n];return e}function t(e){var t=!1;if(e&&e.setItem){t=!0;var n="__"+Math.round(1e7*Math.random());try{e.setItem(n,n),e.removeItem(n)}catch(r){t=!1}}return t}function n(e){var t="undefined"==typeof e?"undefined":(0,s["default"])(e);return"string"===t&&window[e]instanceof Storage?window[e]:e}function r(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())}function o(e,t){if(t=t||new Date,"number"==typeof e?e=e===1/0?_:new Date(t.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e)),e&&!r(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e}function u(e){var t=!1;if(e)if(e.code)switch(e.code){case 22:t=!0;break;case 1014:"NS_ERROR_DOM_QUOTA_REACHED"===e.name&&(t=!0)}else e.number===-2147024882&&(t=!0);return t}function a(e,t){this.c=(new Date).getTime(),t=t||_;var n=o(t);this.e=n.getTime(),this.v=e}function d(e){return"object"===("undefined"==typeof e?"undefined":(0,s["default"])(e))&&!!(e&&"c"in e&&"e"in e&&"v"in e)}function l(e){var t=(new Date).getTime();return t<e.e}function c(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function f(r){var o={storage:"localStorage",exp:1/0},u=e(o,r),a=n(u.storage),i=t(a);this.isSupported=function(){return i},i?(this.storage=a,this.quotaExceedHandler=function(e,t,n,r){if(console.warn("Quota exceeded!"),n&&n.force===!0){var o=this.deleteAllExpires();console.warn("delete all expires CacheItem : ["+o+"] and try execute `set` method again!");try{n.force=!1,this.set(e,t,n)}catch(u){console.warn(u)}}}):e(this,p)}var _=new Date("Fri, 31 Dec 9999 23:59:59 UTC"),h={serialize:function(e){return(0,i["default"])(e)},deserialize:function(e){return e&&JSON.parse(e)}},p={set:function(e,t,n){},get:function(e){},"delete":function(e){},deleteAllExpires:function(){},clear:function(){},add:function(e,t){},replace:function(e,t,n){},touch:function(e,t){}},T={set:function(t,n,r){if(t=c(t),r=e({force:!0},r),void 0===n)return this["delete"](t);var o=h.serialize(n),i=new a(o,r.exp);try{this.storage.setItem(t,h.serialize(i))}catch(d){u(d)?this.quotaExceedHandler(t,o,r,d):console.error(d)}return n},get:function(e){e=c(e);var t=null;try{t=h.deserialize(this.storage.getItem(e))}catch(n){return null}if(d(t)){if(l(t)){var r=t.v;return h.deserialize(r)}this["delete"](e)}return null},"delete":function(e){return e=c(e),this.storage.removeItem(e),e},deleteAllExpires:function(){for(var e=this.storage.length,t=[],n=this,r=0;r<e;r++){var o=this.storage.key(r),u=null;try{u=h.deserialize(this.storage.getItem(o))}catch(a){}if(null!==u&&void 0!==u.e){var i=(new Date).getTime();i>=u.e&&t.push(o)}}return t.forEach(function(e){n["delete"](e)}),t},clear:function(){this.storage.clear()},add:function(t,n,r){t=c(t),r=e({force:!0},r);try{var o=h.deserialize(this.storage.getItem(t));if(!d(o)||!l(o))return this.set(t,n,r),!0}catch(u){return this.set(t,n,r),!0}return!1},replace:function(e,t,n){e=c(e);var r=null;try{r=h.deserialize(this.storage.getItem(e))}catch(o){return!1}if(d(r)){if(l(r))return this.set(e,t,n),!0;this["delete"](e)}return!1},touch:function(e,t){e=c(e);var n=null;try{n=h.deserialize(this.storage.getItem(e))}catch(r){return!1}if(d(n)){if(l(n))return this.set(e,this.get(e),{exp:t}),!0;this["delete"](e)}return!1}};return f.prototype=T,f})},244:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),u=r(o),a=n(123),i=r(a),d=n(144),s=r(d),l=n(23),c=r(l);u["default"].use(i["default"]);var f=new i["default"]({transitionOnLoad:!0});f.beforeEach(function(e){if(e.to.auth){if(!s["default"].state.member.auth)return c["default"].tokenLogin(function(t){s["default"].dispatch("SET_AUTH",t.data.member),e.next()},function(t){var n=encodeURIComponent(e.to.path);e.redirect("/member/login?redirect="+n)});e.next()}else e.next()}),f.map({"*":{name:"404",component:function(e){return n.e(8,function(t){var n=[t(271)];e.apply(null,n)}.bind(this))}},"/boot":{name:"boot",component:function(e){return n.e(6,function(t){var n=[t(275)];e.apply(null,n)}.bind(this))}},"/":{name:"home",component:function(e){return n.e(7,function(t){var n=[t(276)];e.apply(null,n)}.bind(this))}},"/category":{name:"category",component:function(e){return n.e(4,function(t){var n=[t(272)];e.apply(null,n)}.bind(this))}},"/search":{name:"search",component:function(e){return n.e(5,function(t){var n=[t(274)];e.apply(null,n)}.bind(this))}},"goods/list":{name:"goods-list",component:function(e){return n.e(3,function(t){var n=[t(273)];e.apply(null,n)}.bind(this))}},"/member":{name:"member",auth:!0,component:function(e){return n.e(2,function(t){var n=[t(277)];e.apply(null,n)}.bind(this))}},"/member/register":{name:"register",component:function(e){return n.e(1,function(t){var n=[t(279)];e.apply(null,n)}.bind(this))}},"/member/login":{name:"login",component:function(e){return n.e(0,function(t){var n=[t(278)];e.apply(null,n)}.bind(this))}}}),t["default"]=f},247:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(n(10),{added:[{id:2,quantity:6},{id:1,quantity:1},{id:3,quantity:2},{id:4,quantity:8},{id:14,quantity:8},{id:24,quantity:8},{id:34,quantity:8}],goodsMirror:[]}),o={ADD_TO_CART:function(e,t,n){n=Number(n)||1;var r=e.added.find(function(e){return e.id===t.id});r?r.quantity+n>0?r.quantity+=n:e.added.$remove(r):(e.added.push({id:t.id,quantity:n}),e.goodsMirror.find(function(e){return e.id===t.id})||e.goodsMirror.push(Object(t)))},UPDATE_CART_MIRROR:function(e,t){e.goodsMirror=t}};t["default"]={state:r,mutations:o}},248:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o,u=n(107),a=r(u),i=n(10),d={tree:[],currentPid:1},s=(o={},(0,a["default"])(o,i.SET_GOODS_CATEGORY_TREE,function(e,t){e.tree=_.toArray(t)}),(0,a["default"])(o,i.SET_GOODS_CATEGORY_CURRENT_PID,function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];null===t?(_.isEmpty(e.tree)&&setTimeout(function(){return e.currentPid=_.head(_.sortBy(e.tree,"sort")).cid},1e3),e.currentPid=_.head(_.sortBy(e.tree,"sort")).cid):e.currentPid=t}),o);t["default"]={state:d,mutations:s}},249:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o,u=n(107),a=r(u),i=n(242),d=r(i),s=n(238),l=r(s),c=n(10),f={searched:{goods:new l["default"],total:null,page:null,per_page:null},style:"default",loaded:!1,loadedSuccess:!0},h=(o={},(0,a["default"])(o,c.SET_GOODS_LIST,function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];_.isNull(t)?e.searched.goods=new l["default"]:(e.searched.goods=new l["default"]([].concat((0,d["default"])(e.searched.goods),(0,d["default"])(t.goods))),e.searched.total=t.total,e.searched.page=t.page,e.searched.per_page=t.per_page)}),(0,a["default"])(o,c.SET_GOODS_LIST_LOADED,function(e,t){e.loaded=t}),(0,a["default"])(o,c.SET_GOODS_LIST_LOADED_SUCCESS,function(e,t){e.loadedSuccess=t}),o);t["default"]={state:f,mutations:h}},250:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o,u=n(107),a=r(u),i=n(10),d={auth:!1,info:{}},s=(o={},(0,a["default"])(o,i.SET_AUTH,function(e,t){e.auth=!0,e.info=t}),(0,a["default"])(o,i.CANCEL_AUTH,function(e){e.auth=!1,e.info={}}),o);t["default"]={state:d,mutations:s}}});
//# sourceMappingURL=app.13d4236b11e7131b5ef2.js.map